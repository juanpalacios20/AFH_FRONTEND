<div class="relative min-h-screen pb-20">
  <app-menu class="absolute top-0 left-0 p-4"></app-menu>
  <div class="w-full p-5 pt-20">
    <div class="flex justify-between items-center mb-4">
      <h1 class="text-2xl font-bold">AFH: Reportes</h1>
    </div>
  </div>
  <div class="flex justify-center gap-4 mt-6">
    <!-- Selector principal -->
    <p-autocomplete
      [(ngModel)]="selectedFilter"
      [suggestions]="filteredOptions"
      (completeMethod)="filterOption($event)"
      [dropdown]="true"
      (keydown)="blockTyping($event)"
      [forceSelection]="true"
      placeholder="Seleccione una opción"
      class="w-60 bg-white text-black font-normal py-3 rounded-lg transition focus:ring-2 focus:ring-primary-500"
    ></p-autocomplete>

    <!-- Contenedor dinámico de filtros -->
    <div *ngIf="selectedFilter" class="flex flex-col w-80 bg-white rounded-lg">
      <!-- Personalizado -->
      <ng-container *ngIf="selectedFilter === 'PERSONALIZADO'">
        <p-datepicker
          [(ngModel)]="rangeDates"
          (ngModelChange)="onCustomChange()"
          selectionMode="range"
          [readonlyInput]="true"
          [showIcon]="true"
          placeholder="Seleccione rango de fechas"
          fluid="true"
          class="w-full py-3"
        ></p-datepicker>
        <small>Seleccione un intervalo de fechas</small>
      </ng-container>

      <!-- Año -->
      <ng-container *ngIf="selectedFilter === 'AÑO'">
        <p-datepicker
          [(ngModel)]="year"
          view="year"
          (ngModelChange)="onYearChange($event)"
          fluid="true"
          placeholder="Seleccione un año"
          [readonlyInput]="true"
          [showIcon]="true"
          dateFormat="yy"
          class="w-full bg-white text-black font-normal py-3 rounded-lg transition focus:ring-2 focus:ring-primary-500"
        />
      </ng-container>

      <!-- Mes -->
      <ng-container *ngIf="selectedFilter === 'MES'">
        <p-datepicker
          [(ngModel)]="month"
          view="month"
          (ngModelChange)="onMonthChange($event)"
          fluid="true"
          placeholder="Seleccione un mes"
          [readonlyInput]="true"
          [showIcon]="true"
          dateFormat="mm/yy"
          class="w-full bg-white text-black font-normal py-3 rounded-lg transition focus:ring-2 focus:ring-primary-500"
        />
        <small>Seleccione un mes</small>
      </ng-container>
    </div>
  </div>

  <div class="mt-4">
    <h1 class="text font-bold pl-5">Reporte mes {{ nameMonth }}</h1>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <div
        class="bg-white rounded-2xl shadow-md p-6 flex flex-col"
        *ngFor="let element of elements"
      >
        <div class="flex items-center gap-3 mb-4">
          <div class="p-3 rounded-full">
            <i class="{{ element.icon }} text-xl"></i>
          </div>
          <span class="text-lg font-semibold text-gray-700">{{
            element.title
          }}</span>
        </div>
        <div class="flex justify-end">
          <span class="text-3xl font-bold text-gray-900">{{
            element.value
          }}</span>
        </div>
      </div>
    </div>
  </div>
  <div class="mt-10" *ngIf="charMonthVisible || charCustomVisible">
    <h1 class="text font-bold pl-5 mt-4 mb-10">Finanzas mes {{ nameMonth }}</h1>
    <div class="card flex justify-center">
      <p-chart
        type="doughnut"
        [data]="data"
        [options]="options"
        class="w-full md:w-[30rem]"
      />
    </div>
  </div>
  <div class="mt-10 mb-4" *ngIf="charYearVisible">
    <h1 class="text font-bold pl-5 mt-4">Finanzas año {{ yearNumber }}</h1>
    <div class="card flex justify-center p-5">
      <p-chart
        type="bar"
        [data]="dataYear"
        [options]="optionsYear"
        class="h-[25rem] w-full mb-5"
      />
    </div>
  </div>
</div>
